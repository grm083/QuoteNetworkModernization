<aura:component controller="CaseAttachUploadCntrlr" implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId">
    <aura:attribute name="fileNameTxt" type="string" default=""/>
    <aura:attribute name="fileTypeTxt" type="string" default=""/>
    <aura:attribute name="stopLoad" type="Boolean" default="false"/>
    
    <aura:attribute name="items" type="List"/>
    <aura:attribute name="accept" type="List" default="['.jpg', '.jpeg','.png','.doc', '.docx', '.xls', '.xlsx', '.ppt', '.pptx','.pdf', '.msg', '.eml']"/>
    <aura:attribute name="multiple" type="Boolean" default="false"/>
    <aura:attribute name="uploadDisabled" type="Boolean" default="true"/>
    <aura:attribute name="selectedDocumentId" type="string"/>
    <aura:attribute name="lstContentDoc" type="List"/>
    <aura:attribute name="hasModalOpen" type="boolean" default="false"/>
    <aura:attribute name="isModalOpen" type="boolean" default="false"/>
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>

    <!-- added as part of SDT 33127 -->
    <aura:attribute name="showSyncButton" type="Boolean" default="false"/>

    <div class="api_spinner" style="height:6rem">
            <div class="slds-spinner_container">
              <div role="status" class="slds-spinner slds-spinner_medium slds-spinner_brand">
                <span class="slds-assistive-text">Loading</span>
                <div class="slds-spinner__dot-a"></div>
                <div class="slds-spinner__dot-b"></div>
              </div>
            </div>
          </div>

    <div class="success">    
      <!-- Custom DataTable to Display List Of Available ContentDocuments Start-->  
      <table class="slds-table slds-table_cell-buffer slds-table_bordered">
          <thead>
              <tr class="slds-line-height_reset">
                  <th class="slds-text-title_caps" scope="col">
                      <div class="slds-truncate" title="Title">Title</div>
                  </th>
                <!--  <th class="slds-text-title_caps" scope="col">
                      <div class="slds-truncate" title="File Type">File Type</div>
                  </th>-->
                  <th class="slds-text-title_caps" scope="col">
                    <div class="slds-truncate" title="Description">Description</div>
                </th>
              </tr>
          </thead>
          <tbody>
              <aura:iteration items="{!v.lstContentDoc}" var="CD">
                  <tr>
                      <th scope="row">
                          <div class="slds-truncate" title="{!CD.Title}">
                              <!--store contentDocument Id in data-Id attribute-->
                              <a onclick="{!c.getSelected}" data-Id="{!CD.Id}">{!CD.Title}</a>
                          </div>
                      </th>
                     <!-- <th scope="row">
                          <div class="slds-truncate" title="{!CD.FileType}">{!CD.FileType}</div>
                      </th>-->
                      <th scope="row">
                        <div class="slds-truncate" title="{!CD.Description}">{!CD.Description}</div>
                    </th>
                  </tr>  
              </aura:iteration>
          </tbody>
      </table>
      <!-- Custom DataTable to Display List Of Available ContentDocuments End-->  
      <!--###### FILE PREVIEW MODAL BOX START ######--> 
      <aura:if isTrue="{!v.hasModalOpen}">
          <section onclick="{!c.closeModel}"
                  role="dialog"
                  aria-modal="true"
                  class="slds-modal slds-fade-in-open">
              <div class="slds-modal__container">
                  <div class="slds-modal__content slds-p-around_medium slds-text-align_center"
                      style="background: transparent;">
                      <div style="width: 50%; margin: 0 auto; text-align: left">
                          <!--<lightning:fileCard> to preview file using content document Id -->
                          <lightning:fileCard fileId="{!v.selectedDocumentId}"/>
                      </div>
                  </div>
              </div>
          </section>
          <div class="slds-backdrop slds-backdrop_open" style="position:fixed !important;" ></div>
      </aura:if>

      <div class="slds-m-around_xx-small">
        <lightning:button variant="brand"
                          label="Upload Attachments"
                          title="Upload Attachments"
                          onclick="{! c.openUploadModel }" />
<!--added as part of SDT 33127 -->
          <lightning:button variant="brand"
                          label="Sync to Acorn"
                          title="Sync to Acorn"
                          onclick="{! c.onSync }"
                            disabled="{!v.showSyncButton}"/>

        <aura:if isTrue="{!v.isModalOpen}">
            <!-- Upload Detail Modal-->
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open" style="position:fixed !important;">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <!--changes related to SDT-41639-->
                        <lightning:buttonIcon iconName="utility:close"
                                              onclick="{! c.closeUploadModel }"
                                              alternativeText="close"
                                              variant="bare"
                                              class="slds-modal__close"/>
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Upload Attachments</h2>
                    </header>
                    <!--Upload Modal-->
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                        <div class="row">
                            <ui:inputText required="true" label="File Name:" class="fileName" value="{!v.fileNameTxt}"  change="{!c.onChange}" />
                            <ui:inputSelect required="true" label="File Type: " class="dynamic" aura:id="InputSelectDynamic" change="{!c.onChange}" /> 
                        </div>
                        <div>
                            <lightning:fileUpload  aura:id="fileUpload"
                                            name="fileUploader"
                                             label= "Upload Files"
                                             multiple="{!v.multiple}"
                                             accept="{!v.accept}"
                                             disabled="{!v.uploadDisabled}"
                                             recordId="{!v.recordId}"
fileFieldName="IsMajorVersion"
        									 fileFieldValue="false"    
                                             onuploadfinished="{! c.handleUploadFinished }"/>
                        </div>
                    </div>
                    <!--Upload Modal Footer-->
                    <footer class="slds-modal__footer">
                        <lightning:button variant="neutral"
                                          label="Cancel"
                                          title="Cancel"
                                          onclick="{! c.closeUploadModel }"/>
                       <!-- <lightning:button variant="brand"
                                          label="OK"
                                          title="OK"
                                          onclick="{!c.submitDetails}"/>-->
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open" style="position:fixed !important;" ></div>
        </aura:if>
    </div>
  </div>
    <div class="failed slds-text-color_error ">
        No Attachments Found !
    </div>
</aura:component>